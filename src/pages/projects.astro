---
import { Image } from 'astro:assets';
import Layout from '../layouts/Layout.astro';
import project1 from '../assets/imagen-1.jpg';
import project2 from '../assets/imagen-2.jpg';
import project3 from '../assets/imagen-3.jpg';
import project4 from '../assets/imagen-4.jpg';
import project5 from '../assets/imagen-5.jpg';
import project6 from '../assets/imagen-6.jpg';
import project7 from '../assets/imagen-7.jpg';
import project8 from '../assets/imagen-8.jpg';
import project9 from '../assets/imagen-9.jpg';
import project10 from '../assets/imagen-10.jpg';
import project11 from '../assets/imagen-11.jpg';
import project12 from '../assets/imagen-12.jpg';
import project13 from '../assets/imagen-13.jpg';
import project14 from '../assets/imagen-14.jpg';
import project15 from '../assets/imagen-15.jpg';
import project16 from '../assets/imagen-16.jpg';
import project17 from '../assets/imagen-17.jpg';
import project18 from '../assets/imagen-18.jpg';
import project19 from '../assets/imagen-19.jpg';
import project20 from '../assets/imagen-20.jpg';
import project21 from '../assets/imagen-21.jpg';
import project22 from '../assets/imagen-22.jpg';
import project23 from '../assets/imagen-23.jpg';
import project24 from '../assets/imagen-24.jpg';
import project25 from '../assets/imagen-25.jpg';
import project26 from '../assets/imagen-26.jpg';
import project27 from '../assets/imagen-27.jpg';
import project28 from '../assets/imagen-28.jpg';

const projects = [
  { img: project1, title: '', description: '...', tags: ['BRICK'] },
  { img: project2, title: '', description: '...', tags: ['CONCRETE'] },
  { img: project3, title: '', description: '...', tags: ['CONCRETE'] },
  { img: project4, title: '', description: '...', tags: ['CONCRETE'] },
  { img: project5, title: '', description: '...', tags: ['BRICK'] },
  { img: project6, title: '', description: '...', tags: ['BRICK'] },
  { img: project7, title: '', description: '...', tags: ['CONCRETE'] },
  { img: project8, title: '', description: '...', tags: ['CONCRETE'] },
  { img: project9, title: '', description: '...', tags: ['CONCRETE'] },
  { img: project10, title: '', description: '...', tags: ['CONCRETE'] },
  { img: project11, title: '', description: '...', tags: ['OTHERS'] },
  { img: project12, title: '', description: '...', tags: ['CONCRETE'] },
  { img: project13, title: '', description: '...', tags: ['CONCRETE'] },
  { img: project14, title: '', description: '...', tags: ['BRICK'] },
  { img: project15, title: '', description: '...', tags: ['CONCRETE'] },
  { img: project16, title: '', description: '...', tags: ['OTHERS'] },
  { img: project17, title: '', description: '...', tags: ['CONCRETE'] },
  { img: project18, title: '', description: '...', tags: ['CONCRETE'] },
  { img: project19, title: '', description: '...', tags: ['CONCRETE'] },
  { img: project20, title: '', description: '...', tags: ['CONCRETE'] },
  { img: project21, title: '', description: '...', tags: ['BRICK'] },
  { img: project22, title: '', description: '...', tags: ['OTHERS'] },
  { img: project23, title: '', description: '...', tags: ['CONCRETE'] },
  { img: project24, title: '', description: '...', tags: ['CONCRETE'] },
  { img: project25, title: '', description: '...', tags: ['CONCRETE'] },
  { img: project26, title: '', description: '...', tags: ['CONCRETE'] },
  { img: project27, title: '', description: '...', tags: ['CONCRETE'] },
  { img: project28, title: '', description: '...', tags: ['CONCRETE'] }
];
---

<Layout title="Our Projects | Construction Co.">
  <div class="py-16">
    <div class="container mx-auto px-6">
      <div class="text-center mb-12">
        <h1 class="text-4xl font-bold text-gray-800 font-heading">Our Work</h1>
        <p class="text-lg text-gray-600 mt-2">
          A showcase of our commitment to quality and craftsmanship.
        </p>
      </div>

      <!-- Filtros de etiquetas -->
      <div class="flex flex-wrap justify-center gap-4 mb-8">
        <button class="tag-filter px-4 py-2 rounded bg-orange-400 text-gray-800 font-semibold hover:bg-orange-300" data-tag="all">ALL</button>
        <button class="tag-filter px-4 py-2 rounded bg-orange-400 text-gray-800 font-semibold hover:bg-orange-300" data-tag="CONCRETE">CONCRETE</button>
        <button class="tag-filter px-4 py-2 rounded bg-orange-400 text-gray-800 font-semibold hover:bg-orange-300" data-tag="BRICK">BRICK</button>
        <button class="tag-filter px-4 py-2 rounded bg-orange-400 text-gray-800 font-semibold hover:bg-orange-300" data-tag="OTHERS">OTHERS</button>
      </div>

      <div id="projects-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {projects.map((project, idx) => (
          <a href="#" class={`gallery-item group block overflow-hidden rounded-lg shadow-lg aspect-[4/3] relative`} data-title={project.title} data-tags={project.tags.join(',')}>
            <Image 
              src={project.img} 
              alt={project.description} 
              class="absolute inset-0 w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-300 z-0"
            />
            <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent"></div>
            <div class="absolute inset-0 flex items-end p-4 z-20">
              <h3 class="text-white text-xl font-bold font-heading">{project.title}</h3>
            </div>
            <div class="absolute top-2 left-2 z-30">
              {project.tags.map(tag => (
                <span class="inline-block bg-brand-blue text-white text-xs font-semibold rounded px-2 py-1 mr-1 mb-1">{tag}</span>
              ))}
            </div>
          </a>
        ))}
      </div>
    </div>
  </div>
</Layout>

<script src="../scripts/gallery-lightbox.ts"></script>
<script>
  // Filtrado por etiquetas
  document.addEventListener('DOMContentLoaded', function() {
    const buttons = document.querySelectorAll('.tag-filter');
    const items = document.querySelectorAll('#projects-grid .gallery-item');
    buttons.forEach(btn => {
      btn.addEventListener('click', function() {
        const tag = btn.getAttribute('data-tag') ?? '';
        buttons.forEach(b => b.classList.remove('bg-blue-500', 'text-white'));
        btn.classList.add('bg-blue-500', 'text-white');
        items.forEach(item => {
          const tagsAttr = item.getAttribute('data-tags');
          const itemTags = tagsAttr ? tagsAttr.split(',') : [];
          if (tag === 'all' || itemTags.includes(tag)) {
            (item as HTMLElement).style.display = '';
          } else {
            (item as HTMLElement).style.display = 'none';
          }
        });
      });
    });
    // Activar el filtro "Todos" por defecto
    const defaultBtn = document.querySelector('.tag-filter[data-tag="all"]');
    if (defaultBtn && typeof (defaultBtn as HTMLElement).click === 'function') {
      (defaultBtn as HTMLElement).click();
    }
  });
</script>